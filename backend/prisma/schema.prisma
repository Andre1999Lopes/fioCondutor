generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgres"
  url      = env("DATABASE_URL")
}

model Usuario {
  id        Int      @id @default(autoincrement())
  nome      String
  email     String   @unique
  senha     String
  createdAt DateTime @default(now())

  @@map("usuarios")
}

model Aluno {
  id        Int      @id @default(autoincrement())
  nome      String
  email     String   @unique
  telefone  String?
  cpf       String   @unique
  endereco  String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  matriculas Matricula[]
  pagamentos Pagamento[]

  @@map("alunos")
}

model Turma {
  id           Int      @id @default(autoincrement())
  nome         String
  dias_semana  String
  horario      String
  descricao    String?
  vagas_totais Int
  status       String   @default("Ativa")
  createdAt    DateTime @default(now())

  matriculas Matricula[]

  @@map("turmas")
}

model Matricula {
  id             Int      @id @default(autoincrement())
  data_matricula DateTime @default(now())
  ativa          Boolean  @default(true)
  alunoId        Int
  turmaId        Int

  aluno Aluno @relation(fields: [alunoId], references: [id], onDelete: Cascade)
  turma Turma @relation(fields: [turmaId], references: [id], onDelete: Cascade)

  @@unique([alunoId, turmaId])
  @@map("matriculas")
}

model Plano {
  id        Int      @id @default(autoincrement())
  nome      String
  valor     Float
  descricao String?
  duracao   Int?
  ativo     Boolean? @default(true)

  pagamentos Pagamento[]

  @@map("planos")
}

model Pagamento {
  id              Int       @id @default(autoincrement())
  data_vencimento DateTime
  data_pagamento  DateTime?
  valor           Float
  status          String    @default("Pendente")
  mes_referencia  String
  alunoId         Int
  planoId         Int
  createdAt       DateTime  @default(now())

  aluno Aluno @relation(fields: [alunoId], references: [id], onDelete: Cascade)
  plano Plano @relation(fields: [planoId], references: [id])

  @@map("pagamentos")
}
